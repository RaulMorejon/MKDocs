<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Sprint 4 - Ra煤l Morej贸n</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Sprint 4";
        var mkdocs_page_input_path = "sprint4.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Ra煤l Morej贸n
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Inici</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Sprints</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../sprint1/">Sprint 1</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../sprint2/">Sprint 2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../sprint3/">Sprint 3</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Sprint 4</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#1-monitoritzacio">1. MONITORITZACI</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#apartat-addicional-monitoritzacio-remota-de-logs"> Apartat Addicional: Monitoritzaci贸 Remota de Logs</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#servidor-qui-envia-els-logs">Servidor (Qui envia els logs)</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#client-qui-rep-els-logs">Client (Qui rep els logs)</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#comparticio-dels-logs">Compartici贸 dels logs</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#2-administracio-remota-team-viewer">2. ADMINISTRACI REMOTA (TEAM VIEWER)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#3-llicenciament">3. LLICENCIAMENT</a>
    </li>
    </ul>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../permisos/">Pol铆tiques d'煤s i contacte</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Ra煤l Morej贸n</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Sprints</li>
      <li class="breadcrumb-item active">Sprint 4</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="monitoritzacio-connexio-remota-i-llicenciament">Monitoritzaci贸, connexi贸 remota i llicenciament</h1>
<p>Aquest sprint se centra en la monitoritzaci贸 del sistema, la connexi贸 remota i la gesti贸 de llic猫ncies a Linux. La monitoritzaci贸 permet supervisar el rendiment i l'estat dels recursos del sistema, la connexi贸 remota facilita l'administraci贸 segura dels servidors a distncia, i el llicenciament garanteix el compliment de les pol铆tiques d'煤s i distribuci贸 del programari.</p>
<h2 id="1-monitoritzacio">1. MONITORITZACI</h2>
<p>Els <strong>logs</strong> s贸n registres del sistema i aplicacions que documenten esdeveniments, errors i activitats per a la monitoritzaci贸 i seguretat. Es gestionen seguint normes com la <strong>rotaci贸, classificaci贸 per gravetat i retenci贸</strong>. <strong>journalctl</strong> permet consultar logs en <strong>systemd</strong>, amb opcions per veure registres en temps real o filtrar per servei. La seva utilitat principal 茅s <strong>monitoritzar un servidor, detectar problemes i millorar la seguretat i rendiment</strong>.</p>
<p>Primer de tot, anem a <strong><code>/var/log</code></strong>, on s'emmagatzemen els <strong>logs del sistema i aplicacions</strong> a Linux. Cont茅 registres com <strong><code>syslog</code></strong> (esdeveniments), <strong><code>auth.log</code></strong> (autenticaci贸), <strong><code>kern.log</code></strong> (nucli), <strong><code>dmesg</code></strong> (arrencada) i logs de servidors web. s clau per <strong>diagnosticar problemes i monitoritzar el sistema</strong>.</p>
<p><img alt="Visualitzaci贸 del directori /var/log" src="../4.0.png" /></p>
<p>Si accedim a <strong><code>logrotate.conf</code></strong>, podem veure que 茅s on es configura <strong>Logrotate</strong>, que gestiona la <strong>rotaci贸, compressi贸 i eliminaci贸 automtica dels logs</strong>. Permet definir la <strong>freq眉猫ncia</strong>, el <strong>nombre de logs a conservar</strong>, la <strong>compressi贸</strong> i accions abans/despr茅s de la rotaci贸. Les configuracions espec铆fiques es troben a <strong><code>/etc/logrotate.d/</code></strong>.</p>
<p><img alt="Configuraci贸 de Logrotate" src="../4.1.png" /></p>
<p>Si anem a <strong><code>/var/log/ufw.log</code></strong>, trobem que 茅s sotm猫s a la <strong>rotaci贸 de logs</strong> per controlar l'espai en disc. <strong>Logrotate</strong> arxiva, comprimeix i gestiona els logs antics, mantenint-los organitzats sense saturar el sistema. La configuraci贸 es troba a <strong><code>/etc/logrotate.d/ufw</code></strong>.</p>
<p><img alt="Arxiu de rotaci贸 de ufw.log" src="../4.2.png" /></p>
<p>Si volem veure els registres dels esdeveniments, hem d'anar al <strong><code>syslog</code></strong>, ja que 茅s un sistema on es recopila l'informaci贸 del sistema, nucli, serveis i aplicacions. Els logs es poden veure a <strong><code>/var/log/syslog</code></strong> i es poden filtrar per cercar errors o advert猫ncies.</p>
<p><img alt="Visualitzaci贸 de logs a syslog" src="../4.4.png" /></p>
<p>En el <strong><code>syslog.conf</code></strong>, trobem la configuraci贸 de <strong>syslog</strong>, on es defineixen les regles per gestionar els registres d'esdeveniments. Especifica la <strong>prioritat dels missatges</strong> i la <strong>destinaci贸</strong> on s'emmagatzemen, com a fitxers locals o serveis remots. Per aplicar canvis, s'ha de reiniciar el servei <strong>rsyslog</strong>.</p>
<p><img alt="Configuraci贸 de syslog.conf" src="../4.5.png" /></p>
<p>Tamb茅 trobem el fitxer <strong><code>50-default.conf</code></strong> a <strong><code>/etc/logrotate.d/</code></strong>, que configura la <strong>rotaci贸 de logs</strong> per a serveis del sistema. Defineix com es gestionen els logs, incloent la <strong>freq眉猫ncia de rotaci贸</strong>, la <strong>conservaci贸 dels logs antics</strong> i la <strong>compressi贸</strong>. </p>
<p>Aquestes configuracions eviten que els registres d'aquests serveis espec铆fics es guardin en l'arxiu de logs especificat.</p>
<p><img alt="Configuraci贸 de 50-default.conf" src="../4.6.png" /></p>
<p>En aquest punt mantenim obert els logs actual pero veure els canvis a d'alt. Seguidament crearem el <strong>logs</strong></p>
<p>Per crear un <strong>log</strong> utilitzarem la comanda <strong><code>logger -i -s -p</code></strong> que permet registrar missatges en els logs del sistema amb les seg眉ents opcions:</p>
<ul>
<li><strong><code>-i</code></strong>: Inclou l'<strong>ID de proc茅s (PID)</strong> al missatge.</li>
<li><strong><code>-s</code></strong>: Mostra el missatge tamb茅 per <strong>pantalla</strong>.</li>
<li><strong><code>-p</code></strong>: Defineix la <strong>prioritat</strong> del missatge (categoria i nivell de severitat).</li>
</ul>
<p>Exemple: <strong><code>logger -i -s -p mail.err "Missatge"</code></strong> registrar el missatge amb prioritat <strong><code>mail.err</code></strong>, incloent el PID i mostrant-lo a la pantalla. I es pot veure que surt al <strong><code>/var/log/syslog</code></strong></p>
<p><img alt="Visualitzaci贸 del log a /var/log/syslog" src="../4.7.png" /></p>
<p>La frase corregida seria:</p>
<p>Si accedim als logs de <strong><code>mail.log</code></strong>, trobarem el log que acabem de crear amb el <strong>missatge</strong>, ja que estava definit que es redirig铆s a aquest fitxer de logs. </p>
<p><img alt="Log a mail.log" src="../4.8.png" /></p>
<p>Tamb茅, si es posa <strong><code>mail.=alert</code></strong> al fitxer <strong><code>50-default.conf</code></strong>, nom茅s es registraran els missatges del servei de <strong>mail</strong> amb <strong>prioritat <code>alert</code></strong> o m茅s alta, indicant situacions que requereixen atenci贸 immediata. Els missatges de menor severitat seran ignorats. Igualment, amb la <strong>prioritat <code>crit</code></strong>, els missatges es redireccionaran al <strong><code>/var/log/mail.log</code></strong>.</p>
<p><img alt="Configuraci贸 de prioritat alert a 50-default.conf" src="../4.9.png" /></p>
<p>Per fer un exemple, farem el mateix per貌 canviant per a qu猫 totes les <strong>prioritats amb <code>*.crit</code> m茅s altes</strong> es redireccionin a <strong><code>/var/log/raul.log</code></strong>.</p>
<p><img alt="Configuraci贸 per redireccionar a raul.log" src="../4.15.png" /></p>
<p>Creem un log amb la <strong>prioritat <code>emerg</code></strong> i ara, si anem al <strong><code>/var/log/mail.log</code></strong>, veurem que no est aquest log (mirant el seu PID), per貌 si anem a <strong><code>/var/log/raul.log</code></strong>, s铆 que el trobarem, ja que 茅s de prioritat m茅s alta.</p>
<p><img alt="Log amb prioritat emerg a raul.log" src="../4.16.png" /></p>
<hr />
<p>Per tindre-ho mes clar podem veure els nivells de prioritats en <strong>syslog</strong> es classifiquen en 8 nivells de severitat, de m茅s baix a m茅s alt:</p>
<ol>
<li><strong><code>debug</code></strong>: Informaci贸 detallada 煤til per a la depuraci贸.</li>
<li><strong><code>info</code></strong>: Missatges informatius que indiquen el bon funcionament del sistema.</li>
<li><strong><code>notice</code></strong>: Missatges normals, per貌 importants, per a l'operaci贸 del sistema.</li>
<li><strong><code>warning</code></strong>: Advert猫ncies de possibles problemes, per貌 no cr铆tiques.</li>
<li><strong><code>err</code></strong>: Errors que poden afectar el funcionament, per貌 no s贸n cr铆tics.</li>
<li><strong><code>crit</code></strong>: Condicions cr铆tiques que necessiten atenci贸 immediata.</li>
<li><strong><code>alert</code></strong>: Problemes molt greus que requereixen una resposta immediata.</li>
<li><strong><code>emerg</code></strong>: Problemes cr铆tics que impliquen una fallada total del sistema.</li>
</ol>
<p>Els missatges amb una prioritat m茅s alta inclouen tamb茅 els de prioritats m茅s baixes.</p>
<hr />
<p>Amb el <strong><code>journalctl</code></strong> podem visualitzar i gestionar els registres del sistema guardats pel sistema de registre <strong><code>systemd</code></strong>. Ens permet consultar els logs del sistema de manera eficient, filtrar per data, servei o nivell de severitat, i veure missatges d'error, advert猫ncies, entre d'altres.</p>
<p>Per exemple, podem filtrar per les <strong>prioritats <code>alert</code></strong>:</p>
<p><img alt="Visualitzaci贸 de logs amb prioritat alert" src="../4.17.png" /></p>
<p>I seguidament, amb la comanda <strong><code>journalctl -u cron</code></strong>, podem veure els registres del servei <strong><code>cron</code></strong> gestionats per <strong><code>systemd</code></strong>. El parmetre <strong><code>-u</code></strong> indica que es volen mostrar els logs d'un <strong>servei espec铆fic</strong>. En aquest cas, es mostraran els missatges relacionats amb el servei de <strong>cron</strong>, que gestiona les tasques programades en el sistema:</p>
<p><img alt="Logs del servei cron" src="../4.18.png" /></p>
<p><img alt="Visualitzaci贸 de logs del servei cron" src="../4.19.png" /></p>
<h3 id="apartat-addicional-monitoritzacio-remota-de-logs"> Apartat Addicional: Monitoritzaci贸 Remota de Logs</h3>
<p>Un <strong>apartat addicional</strong> que podem implementar 茅s la possibilitat d'enviar els <strong>logs generats</strong> per una mquina a una <strong>carpeta compartida</strong> amb una altra mquina.  </p>
<ul>
<li><strong>Avantatge:</strong> Aix貌 permet una <strong>monitoritzaci贸 remota</strong> m茅s eficient i centralitzada, facilitant la supervisi贸 i anlisi dels registres en temps real.  </li>
</ul>
<h4 id="servidor-qui-envia-els-logs">Servidor (Qui envia els <strong>logs</strong>)</h4>
<p>Primer de tot, instal路larem <code>nfs-kernel-server</code>, ja que la compartici贸 es far a trav茅s de <strong>NFS</strong>.  </p>
<p><img alt="Instal路laci贸 del servidor NFS" src="../4.20.1-1.png" /></p>
<p>Seguidament, anirem a l'arrel del nostre directori per crear una carpeta <em>(</em><em>logs</em><em>)</em> on guardarem tots els <strong>logs</strong> que ens interessen.  </p>
<p>A m茅s, assignarem permisos a la carpeta perqu猫, de moment, tothom hi tingui acc茅s. <em>(M茅s endavant, es podrien restringir els permisos a un grup redu茂t de persones, com administradors...)</em>.  </p>
<p><img alt="Creaci贸 i assignaci贸 de permisos a la carpeta logs" src="../4.20-1.png" /> </p>
<p>En aquest punt, volem que la carpeta <strong><code>/logs</code></strong> sigui la carpeta compartida entre les mquines.<br />
Per aquest motiu, anem a <strong><code>/etc/exports</code></strong> per introduir la seg眉ent l铆nia:  </p>
<p><img alt="Configuraci贸 de /etc/exports" src="../4.21-1.png" /> </p>
<p>Un cop guardats els canvis, reiniciem els serveis per aplicar-los i assegurar-nos que la configuraci贸 s'ha efectuat correctament.  </p>
<p><img alt="Reinici dels serveis NFS" src="../4.22-1.png" /> </p>
<h4 id="client-qui-rep-els-logs">Client (Qui rep els <strong>logs</strong>)</h4>
<p>A la mquina client, hem d'instal路lar <code>nfs-common</code> amb la seg眉ent comanda:  </p>
<p><img alt="Instal路laci贸 de nfs-common al client" src="../4.23-1.png" /> </p>
<p>Creem una carpeta a l'arrel anomenada <strong><code>/muntatge</code></strong> i ens desplacem cap a ella.  </p>
<p><img alt="Creaci贸 del directori /muntatge" src="../4.24-1.png" /> </p>
<p>Muntem el directori <strong><code>/logs</code></strong> del servidor al directori <strong><code>/muntatge</code></strong> del client, indicant sempre la <strong>IP del servidor</strong>:  </p>
<p><img alt="Muntatge del directori /logs" src="../4.25-1.png" /> </p>
<h4 id="comparticio-dels-logs">Compartici贸 dels logs</h4>
<p>Un cop fets els passos anteriors, anem al <strong>Server</strong> i editem el fitxer <strong><code>50-default.conf</code></strong> per modificar la l铆nia de <strong><code>mail.=alert</code></strong>, indicant que quan es generi aquest log, es guardi a <strong><code>/logs/nfs.log</code></strong>.  </p>
<ul>
<li><strong>Punt important:</strong> Com que el directori <strong><code>/logs</code></strong> 茅s compartit amb el client a trav茅s del directori <strong><code>/muntatge</code></strong>, qualsevol log creat i desat a <strong><code>/logs</code></strong> ser tamb茅 guardat a <strong><code>/muntatge</code></strong> i, per tant, visible al client.  </li>
</ul>
<p><img alt="Configuraci贸 del fitxer 50-default.conf" src="../4.26-1.png" /> </p>
<p>A la part superior de la imatge, veiem el client accedint al directori <strong><code>/muntatge</code></strong>, mentre que a la part inferior hi ha el servidor.  </p>
<p>En aquest punt, al servidor, creem una alerta de <strong><code>mail</code></strong> amb prioritat <strong><code>alert</code></strong> i un missatge.  </p>
<p>Com podem observar, l'alerta no es reflecteix ni als logs actuals de la mquina ni al directori del client, ja que encara no s'ha enviat l'ordre de creaci贸 del log.  </p>
<p><img alt="Creaci贸 d'un log d'alerta" src="../4.27-1.png" /> </p>
<p>En aquest punt, acabem d'enviar la comanda per crear el <strong>log</strong>. Ara, el podem veure als <strong>logs</strong> de la nostra mquina i, si fem un <strong><code>ls -l</code></strong> al client, tamb茅 hi ser visible.  </p>
<p>Aix铆, podem comprovar que el fitxer amb el log creat ha estat rebut correctament pel client.  </p>
<p><img alt="Log creat visible al client" src="../4.28-1.png" /> </p>
<p>Comprovaci贸 del fitxer <code>nfs.log</code> del client:</p>
<p><img alt="Comprovaci贸 del fitxer nfs.log" src="../4.29-1.png" /> </p>
<p>Una 煤ltima comprovaci贸 consisteix a crear un <strong>log</strong> amb prioritat <strong><code>alert</code></strong> i verificar que arriba al client, per貌 no es guarda al fitxer <strong><code>mail.log</code></strong> del servidor, ja que ha de ser enviat al directori compartit <strong><code>/logs</code></strong>.  </p>
<p>Aix铆, el <strong>log</strong> es desar en el directori compartit i ser visible tant al servidor com al client, per貌 no al fitxer <strong><code>mail.log</code></strong>.  </p>
<p><img alt="Verificaci贸 de la creaci贸 del log en el directori compartit" src="../4.30-1.jpg" /></p>
<h2 id="2-administracio-remota-team-viewer">2. ADMINISTRACI REMOTA (TEAM VIEWER)</h2>
<h2 id="3-llicenciament">3. LLICENCIAMENT</h2>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../sprint3/" class="btn btn-neutral float-left" title="Sprint 3"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../permisos/" class="btn btn-neutral float-right" title="Pol铆tiques d'煤s i contacte">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../sprint3/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../permisos/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
